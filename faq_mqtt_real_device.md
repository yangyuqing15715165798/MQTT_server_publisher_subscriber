# 通过网线连接真实设备进行MQTT通信常见问题与配置说明

## 1. 真实设备MQTT客户端配置

- 设备作为MQTT客户端时，需要配置**MQTT服务器的IP地址和端口**。
- 服务器地址应填写你的PC或服务器的局域网IP（如192.168.1.100），**不能用localhost/127.0.0.1**。
- 端口通常为1883（或你自定义的端口）。
- 用户名/密码按Web管理界面设置（如有）。

**示例：**
- 服务器地址：`192.168.1.100`
- 端口：`1883`
- 用户名/密码：按实际配置

---

## 2. Python端/服务端配置

### （1）MQTT Broker监听外网/局域网
- 启动run.py或api_server.py时，host参数要用0.0.0.0：
  ```bash
  python run.py --mqtt-host 0.0.0.0 --mqtt-port 1883
  ```
- 确认防火墙已放行1883端口。

### （2）客户端/发布者/订阅者
- 在其他电脑运行waveform_gui.py或mqtt_client.py时，broker参数要写服务器的局域网IP：
  ```bash
  python mqtt_client.py --broker 192.168.1.100 --port 1883
  ```

---

## 3. 真实设备与PC网络互通
- 确保设备和PC在同一局域网（同一交换机/路由器）。
- 可用ping命令测试：
  ```bash
  ping 192.168.1.100
  ```

---

## 4. 主题与数据格式
- 设备发布/订阅的主题要和服务端/可视化端一致（如`realtime_waveform`）。
- 数据格式（如JSON结构）要和Python端保持一致，便于解析和可视化。

---

## 5. 用户名/密码/权限
- 如果Web管理界面设置了用户名和密码，设备端也要配置一致。
- 未启用认证时，设备可匿名连接。

---

## 6. 典型场景举例
- PC作为MQTT服务器，IP为192.168.1.100。
- 真实设备配置MQTT服务器为192.168.1.100:1883。
- waveform_gui.py、mqtt_client.py等也用192.168.1.100作为broker地址。
- 主题、数据格式保持一致。

---

## 7. 其他注意事项
- 不同网段需做路由或端口映射。
- 工业设备需确认MQTT协议版本兼容（如3.1.1）。
- 生产环境建议加密（TLS/SSL）和认证。

---

## 总结

只要设备能访问MQTT服务器IP和端口，配置正确，主题和数据格式一致，就能实现跨设备、跨平台的MQTT通信。

如有具体设备型号或配置界面，可进一步定制配置说明。 